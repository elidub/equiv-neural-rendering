src_path: /home/lcur1646/equiv-neural-rendering/src/scripts/../
Saving to /home/lcur1646/equiv-neural-rendering/src/scripts/../train_results/2023-05-18_12-58_rototrans_lr1e-7
Forward renderer
----------------

3D Layers
---------
name         	 in_shape       	 out_shape      	 num_params 	 feat_size 
---------------------------------------------------------------------------------------------
Conv3D       	 (64, 16, 16, 16) 	 (64, 16, 16, 16) 	 4160       	 262144    
ResBlock3D   	 (64, 16, 16, 16) 	 (64, 16, 16, 16) 	 119168     	 262144    
ResBlock3D   	 (64, 16, 16, 16) 	 (64, 16, 16, 16) 	 119168     	 262144    
Conv3D       	 (64, 16, 16, 16) 	 (128, 8, 8, 8) 	 524416     	 65536     
ResBlock3D   	 (128, 8, 8, 8) 	 (128, 8, 8, 8) 	 475904     	 65536     
ResBlock3D   	 (128, 8, 8, 8) 	 (128, 8, 8, 8) 	 475904     	 65536     
ConvTr3D     	 (128, 8, 8, 8) 	 (32, 16, 16, 16) 	 262176     	 131072    
ResBlock3D   	 (32, 16, 16, 16) 	 (32, 16, 16, 16) 	 29888      	 131072    
ResBlock3D   	 (32, 16, 16, 16) 	 (32, 16, 16, 16) 	 29888      	 131072    
---------------------------------------------------------------------------------------------
Total        	 (64, 16, 16, 16) 	 (32, 16, 16, 16) 	 2040992    	 65536     


Projection
----------
name         	 in_shape       	 out_shape      	 num_params 	 feat_size 
---------------------------------------------------------------------------------------------
Reshape      	 (32, 16, 16, 16) 	 (512, 16, 16)  	 0          	 131072    
Conv2D       	 (512, 16, 16)  	 (512, 16, 16)  	 262656     	 131072    
Conv2D       	 (512, 16, 16)  	 (256, 16, 16)  	 131328     	 65536     
Conv2D       	 (256, 16, 16)  	 (256, 16, 16)  	 65792      	 65536     
---------------------------------------------------------------------------------------------
Total        	 (32, 16, 16, 16) 	 (256, 16, 16)  	 461312     	 65536     


2D Layers
---------
name         	 in_shape       	 out_shape      	 num_params 	 feat_size 
---------------------------------------------------------------------------------------------
Conv2D       	 (256, 16, 16)  	 (128, 16, 16)  	 32896      	 32768     
ResBlock2D   	 (128, 16, 16)  	 (128, 16, 16)  	 180992     	 32768     
ResBlock2D   	 (128, 16, 16)  	 (128, 16, 16)  	 180992     	 32768     
Conv2D       	 (128, 16, 16)  	 (256, 8, 8)    	 524544     	 16384     
ResBlock2D   	 (256, 8, 8)    	 (256, 8, 8)    	 722432     	 16384     
ConvTr2D     	 (256, 8, 8)    	 (128, 16, 16)  	 524416     	 32768     
ResBlock2D   	 (128, 16, 16)  	 (128, 16, 16)  	 180992     	 32768     
ConvTr2D     	 (128, 16, 16)  	 (128, 32, 32)  	 262272     	 131072    
ResBlock2D   	 (128, 32, 32)  	 (128, 32, 32)  	 180992     	 131072    
ConvTr2D     	 (128, 32, 32)  	 (64, 64, 64)   	 131136     	 262144    
ResBlock2D   	 (64, 64, 64)   	 (64, 64, 64)   	 45440      	 262144    
ResBlock2D   	 (64, 64, 64)   	 (64, 64, 64)   	 45440      	 262144    
Conv2D       	 (64, 64, 64)   	 (3, 64, 64)    	 195        	 12288     
---------------------------------------------------------------------------------------------
Total        	 (256, 16, 16)  	 (3, 64, 64)    	 3013891    	 12288     


Inverse renderer
----------------

Inverse 2D Layers
-----------------
name         	 in_shape       	 out_shape      	 num_params 	 feat_size 
---------------------------------------------------------------------------------------------
Conv2D       	 [3, 64, 64]    	 (64, 64, 64)   	 256        	 262144    
ResBlock2D   	 (64, 64, 64)   	 (64, 64, 64)   	 45440      	 262144    
ResBlock2D   	 (64, 64, 64)   	 (64, 64, 64)   	 45440      	 262144    
Conv2D       	 (64, 64, 64)   	 (128, 32, 32)  	 131200     	 131072    
ResBlock2D   	 (128, 32, 32)  	 (128, 32, 32)  	 180992     	 131072    
Conv2D       	 (128, 32, 32)  	 (128, 16, 16)  	 262272     	 32768     
ResBlock2D   	 (128, 16, 16)  	 (128, 16, 16)  	 180992     	 32768     
Conv2D       	 (128, 16, 16)  	 (256, 8, 8)    	 524544     	 16384     
ResBlock2D   	 (256, 8, 8)    	 (256, 8, 8)    	 722432     	 16384     
ConvTr2D     	 (256, 8, 8)    	 (128, 16, 16)  	 524416     	 32768     
ResBlock2D   	 (128, 16, 16)  	 (128, 16, 16)  	 180992     	 32768     
ResBlock2D   	 (128, 16, 16)  	 (128, 16, 16)  	 180992     	 32768     
---------------------------------------------------------------------------------------------
Total        	 [3, 64, 64]    	 (128, 16, 16)  	 2981248    	 16384     


Inverse Projection
------------------
name         	 in_shape       	 out_shape      	 num_params 	 feat_size 
---------------------------------------------------------------------------------------------
Conv2D       	 (128, 16, 16)  	 (256, 16, 16)  	 33024      	 65536     
Conv2D       	 (256, 16, 16)  	 (512, 16, 16)  	 131584     	 131072    
Conv2D       	 (512, 16, 16)  	 (1024, 16, 16) 	 525312     	 262144    
Reshape      	 (1024, 16, 16) 	 (64, 16, 16, 16) 	 0          	 262144    
---------------------------------------------------------------------------------------------
Total        	 (128, 16, 16)  	 (64, 16, 16, 16) 	 691456     	 65536     


Inverse 3D Layers
-----------------
name         	 in_shape       	 out_shape      	 num_params 	 feat_size 
---------------------------------------------------------------------------------------------
Conv3D       	 (64, 16, 16, 16) 	 (32, 16, 16, 16) 	 2080       	 131072    
ResBlock3D   	 (32, 16, 16, 16) 	 (32, 16, 16, 16) 	 29888      	 131072    
ResBlock3D   	 (32, 16, 16, 16) 	 (32, 16, 16, 16) 	 29888      	 131072    
Conv3D       	 (32, 16, 16, 16) 	 (128, 8, 8, 8) 	 262272     	 65536     
ResBlock3D   	 (128, 8, 8, 8) 	 (128, 8, 8, 8) 	 475904     	 65536     
ResBlock3D   	 (128, 8, 8, 8) 	 (128, 8, 8, 8) 	 475904     	 65536     
ConvTr3D     	 (128, 8, 8, 8) 	 (64, 16, 16, 16) 	 524352     	 262144    
ResBlock3D   	 (64, 16, 16, 16) 	 (64, 16, 16, 16) 	 119168     	 262144    
ResBlock3D   	 (64, 16, 16, 16) 	 (64, 16, 16, 16) 	 119168     	 262144    
---------------------------------------------------------------------------------------------
Total        	 (64, 16, 16, 16) 	 (64, 16, 16, 16) 	 2039008    	 65536     


Scene Representation:
	Shape: (64, 16, 16, 16)
	Size: 111104

Number of parameters: 11227907

Traceback (most recent call last):
  File "/home/lcur1646/equiv-neural-rendering/src/scripts/experiments.py", line 68, in <module>
    dataloader = scene_render_dataloader(path_to_data=config["path_to_data"],
  File "/home/lcur1646/equiv-neural-rendering/src/scripts/../enr/misc/dataloaders.py", line 27, in scene_render_dataloader
    dataset = scene_render_dataset(path_to_data, img_size, crop_size)
  File "/home/lcur1646/equiv-neural-rendering/src/scripts/../enr/misc/dataloaders.py", line 54, in scene_render_dataset
    dataset = SceneRenderDataset(path_to_data=path_to_data,
  File "/home/lcur1646/equiv-neural-rendering/src/scripts/../enr/misc/dataloaders.py", line 119, in __init__
    for key, value in render_params[img_idx].items()}
KeyError: '00002'
srun: error: r28n2: task 0: Exited with exit code 1
